@page
@model CarRentalApp.Pages.RentApp.RentalListModel
@{
    ViewData["Title"] = "Rental List";
}

<h2>Rental List</h2>

<form method="get" class="mb-3">
    <label for="filter">Sort by:</label>
    <select name="Filter" onchange="this.form.submit()">
        <option value="">Default</option>
        <option value="Id" selected="@("Id" == Model.Filter)">by Id</option>
        <option value="Name" selected="@("Name" == Model.Filter)">by Name</option>
        <option value="Car Id" selected="@("Car Id" == Model.Filter)">by Car Id</option>
        <option value="Car Make" selected="@("Car Make" == Model.Filter)">by Car Make</option>
        <option value="Car Model" selected="@("Car Model" == Model.Filter)">by Car Model</option>
        <option value="Rent Date" selected="@("Rent Date" == Model.Filter)">by Rent Date</option>
        <option value="Return Date" selected="@("Return Date" == Model.Filter)">by Return Date</option>
    </select>
</form>

@if (Model.Rentals.Count == 0)
{
    <p>No rentals found.</p>
}
else
{
    <table class="table">
        <thead>
            <tr>


                <th>ID</th>
                <th>Customer Name</th>
                <th>Car ID</th>
                <th>Car Make</th>
                <th>Car Model</th>
                <th>Rent Date</th>
                <th>Return Date</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var rental in Model.Rentals)
            {
                <tr>
                    <td>@rental.Id</td>
                    <td>@rental.UserName</td>
                    <td>@rental.CarId</td>
                    <td>@rental.Car?.Make</td>
                    <td>@rental.Car?.Model</td>
                    <td>@rental.RentDate.ToShortDateString()</td>
                    <td>@(rental.ReturnDate?.ToShortDateString() ?? "Not returned")</td>
                </tr>
            }
        </tbody>
    </table>

    //Pagination
    <div>
        <ul class="pagination">
            @for (var i = 1; i <= Model.TotalPages; i++)
            {
                <li class="page-item @(i == Model.PageNumber ? "active" : "")">
                    <a asp-page="/pagination" asp-route-currentpage="@i" class="page-link">@i</a>
                </li>
            }
        </ul>
    </div>
}