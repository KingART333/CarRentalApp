@page
@model CarRentalApp.Pages.RentApp.CarDetailsModel
@{
    ViewData["Title"] = "Car Details";
    var folderName = Model.SelectedCar.Make + " " + Model.SelectedCar.Model;
    var basePath = "/ImagesForTesting/" + folderName;
}

<div style="display: flex; flex-direction: column; align-items: center; justify-content:center;">
    <h1>@Model.SelectedCar.Make @Model.SelectedCar.Model</h1>

    <!-- SUCCESS MESSAGE -->
    @if (TempData["Message"] != null)
    {
        <p style="color: green;">@TempData["Message"]</p>
    }

    <!-- MAIN IMAGE -->
    <div class="text-center">
        <img id="mainImage"
             src="@($"{basePath}/1.jpg")"
             alt="Main Car Image"
             style="max-width: 500px; height:400px; margin-bottom:20px; object-fit: contain;" />
    </div>

    <p><strong>Price per day:</strong> $@Model.SelectedCar.PricePerDay</p>

    @if (Model.SelectedCar.IsAvailable)
    {
        <!-- RENTAL FORM -->
        <form method="post" style="margin: 20px;">
            <label for="days">Number of days to rent:</label>
            <input type="number" id="days" name="days" min="1" required />
            <input type="hidden" name="id" value="@Model.SelectedCar.Id" />
            <button type="submit">Rent this car</button>
        </form>
    }
    else
    {
        <p style="color:red;"><strong>This car is rented until @Model.SelectedCar.RentedUntil?.ToString("dd MMM yyyy")</strong></p>
    }

    <!-- THUMBNAILS -->
    <div class="text-center">
        @for (int i = 1; i <= 6; i++)
        {
            var thumbPath = $"{basePath}/{i}.jpg";
            <img src="@thumbPath"
                 onclick="changeMainImage('@thumbPath')"
                 style="width: 100px; height: auto; margin: 5px; cursor: pointer; border: 1px solid gray; object-fit: contain;" />
        }
    </div>
</div>

@section Scripts {
    <script>
        function changeMainImage(newSrc) {
            document.getElementById('mainImage').src = newSrc;
        }
    </script>
}
